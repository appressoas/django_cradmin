(function(){angular.module("djangoCradmin.acemarkdown",[]).directive("djangoCradminAcemarkdown",function(){return{restrict:"A",transclude:!0,templateUrl:"acemarkdown/acemarkdown.tpl.html",scope:{config:"=djangoCradminAcemarkdown"},controller:function($scope){this.setEditor=function(editorScope){return $scope.editor=editorScope,$scope.editor.aceEditor.on("focus",function(){return $scope.element.addClass("cradmin-focus")}),$scope.editor.aceEditor.on("blur",function(){return $scope.element.removeClass("cradmin-focus")})},this.setTextarea=function(textareaScope){return $scope.textarea=textareaScope,$scope.editor.setValue($scope.textarea.getValue())},this.setTextAreaValue=function(value){return $scope.textarea.setValue(value)},this.focusOnEditor=function(){return $scope.editor.focus()},this.editorSurroundSelectionWith=function(options){return $scope.editor.surroundSelectionWith(options)}},link:function(scope,element){var theme;return scope.element=element,scope.config.showTextarea&&element.addClass("cradmin-acemarkdown-textareavisible"),theme=scope.config.theme,theme||(theme="tomorrow"),scope.editor.setTheme(theme)}}}).directive("djangoCradminAcemarkdownEditor",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",template:"<div></div>",scope:{},controller:function($scope){$scope.setValue=function(value){return $scope.aceEditor.getSession().setValue(value)},$scope.focus=function(){return $scope.aceEditor.focus()},$scope.setTheme=function(theme){return $scope.aceEditor.setTheme("ace/theme/"+theme)},$scope.onChange=function(){var value;return value=$scope.aceEditor.getSession().getValue(),$scope.markdownCtrl.setTextAreaValue(value)},$scope.surroundSelectionWith=function(options){var emptyText,newlines,noSelection,post,pre,selectedText,selectionRange;return pre=options.pre,post=options.post,emptyText=options.emptyText,null==emptyText&&(emptyText=""),null==pre&&(pre=""),null==post&&(post=""),selectionRange=$scope.aceEditor.getSelectionRange(),selectedText=$scope.aceEditor.session.getTextRange(selectionRange),noSelection=""===selectedText,noSelection&&(selectedText=emptyText),$scope.aceEditor.insert(""+pre+selectedText+post),noSelection&&(newlines=pre.split("\n").length-1,selectionRange.start.row+=newlines,selectionRange.end.row=selectionRange.start.row,selectionRange.start.column+=pre.length-newlines,selectionRange.end.column+=pre.length-newlines+emptyText.length,$scope.aceEditor.getSelection().setSelectionRange(selectionRange)),$scope.aceEditor.focus()}},link:function(scope,element,attrs,markdownCtrl){var session;scope.markdownCtrl=markdownCtrl,scope.aceEditor=ace.edit(element[0]),scope.aceEditor.setHighlightActiveLine(!1),scope.aceEditor.setShowPrintMargin(!1),scope.aceEditor.renderer.setShowGutter(!1),session=scope.aceEditor.getSession(),session.setMode("ace/mode/markdown"),session.setUseWrapMode(!0),session.setUseSoftTabs(!0),scope.aceEditor.on("change",function(){return scope.onChange()}),markdownCtrl.setEditor(scope)}}}).directive("djangoCradminAcemarkdownTool",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{config:"=djangoCradminAcemarkdownTool"},link:function(scope,element,attr,markdownCtrl){element.on("click",function(e){return e.preventDefault(),markdownCtrl.editorSurroundSelectionWith(scope.config)})}}}).directive("djangoCradminAcemarkdownLink",["$window",function($window){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{config:"=djangoCradminAcemarkdownLink"},link:function(scope,element,attr,markdownCtrl){element.on("click",function(e){var url;return e.preventDefault(),url=$window.prompt(scope.config.help,""),null!=url?markdownCtrl.editorSurroundSelectionWith({pre:"[",post:"]("+url+")",emptyText:scope.config.emptyText}):void 0})}}}]).directive("djangoCradminAcemarkdownTextarea",function(){return{require:"^djangoCradminAcemarkdown",restrict:"A",scope:{},controller:function($scope){$scope.getValue=function(){return $scope.textarea.val()},$scope.setValue=function(value){return $scope.getValue()!==value?$scope.textarea.val(value):void 0}},link:function(scope,element,attrs,markdownCtrl){scope.textarea=element,scope.textarea.addClass("cradmin-acemarkdowntextarea"),scope.textarea.on("focus",function(){return markdownCtrl.focusOnEditor()}),markdownCtrl.setTextarea(scope)}}})}).call(this),function(){angular.module("djangoCradmin.directives",[]).directive("djangoCradminBack",function(){return{restrict:"A",link:function(scope,element){element.on("click",function(){return history.back(),scope.$apply()})}}}).directive("djangoCradminFormAction",function(){return{restrict:"A",scope:{value:"=djangoCradminFormAction"},controller:function($scope){$scope.$watch("value",function(newValue){return $scope.element.attr("action",newValue)})},link:function(scope,element){scope.element=element}}})}.call(this),function(){angular.module("djangoCradmin.forms.modelchoicefield",[]).directive("djangoCradminModelChoiceFieldWrapper",["$window",function($window){return{restrict:"A",scope:{},controller:function($scope){this.setIframeWrapper=function(iframeWrapperScope){return $scope.iframeWrapperScope=iframeWrapperScope},this.setHiddenField=function(hiddenFieldScope){return $scope.hiddenFieldScope=hiddenFieldScope},this.onChangeValueBegin=function(){return $scope.iframeWrapperScope.show()},$scope.origin=""+window.location.protocol+"//"+window.location.host,$scope.onValueChangeMessage=function(event){var data;return event.origin!==$scope.origin?void console.error("Message origin '"+event.origin+"' does not match current origin '"+$scope.origin+"'."):(data=angular.fromJson(event.data),$scope.hiddenFieldScope.setValue(data.selected_fieldid,data.selected_value),$scope.iframeWrapperScope.hide())},$window.addEventListener("message",$scope.onValueChangeMessage,!1)},link:function(){}}}]).directive("djangoCradminModelChoiceFieldHiddenInput",["$window",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},controller:function($scope){$scope.setValue=function(fieldid,value){return fieldid===$scope.hiddenInputFieldid?$scope.hiddenInputElement.val(value):void 0}},link:function(scope,element,attrs,wrapperCtrl){scope.hiddenInputElement=element,scope.hiddenInputFieldid=attrs.id,wrapperCtrl.setHiddenField(scope)}}}]).directive("djangoCradminModelChoiceFieldChangebeginButton",["$window",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},link:function(scope,element,attrs,wrapperCtrl){element.on("click",function(e){return e.preventDefault(),wrapperCtrl.onChangeValueBegin()})}}}]).directive("djangoCradminModelChoiceFieldIframeWrapper",function(){return{require:"^djangoCradminModelChoiceFieldWrapper",restrict:"A",scope:{},controller:function($scope){$scope.show=function(){return $scope.iframeWrapperElement.removeClass("ng-hide")},$scope.hide=function(){return $scope.iframeWrapperElement.addClass("ng-hide")},this.closeIframe=function(){return $scope.hide()}},link:function(scope,element,attrs,wrapperCtrl){scope.iframeWrapperElement=element,wrapperCtrl.setIframeWrapper(scope)}}}).directive("djangoCradminModelChoiceFieldIframeClosebutton",function(){return{require:"^djangoCradminModelChoiceFieldIframeWrapper",restrict:"A",scope:{},link:function(scope,element,attrs,iframeWrapperCtrl){element.on("click",function(e){return e.preventDefault(),iframeWrapperCtrl.closeIframe()})}}})}.call(this),function(){angular.module("djangoCradmin.forms.usethisbutton",[]).directive("djangoCradminUseThis",["$window",function($window){return{restrict:"A",scope:{value:"@djangoCradminUseThis",fieldid:"@djangoCradminFieldid"},link:function(scope,element){scope.iframeWrapperElement=element,element.on("click",function(e){return e.preventDefault(),$window.parent.postMessage(angular.toJson({postmessageid:"django-cradmin-usethis",selected_fieldid:scope.fieldid,selected_value:scope.value}),window.parent.location.href)})}}}])}.call(this),function(){angular.module("djangoCradmin.imagepreview",[]).directive("djangoCradminImagePreview",function(){var controller;return controller=function($scope){this.setImg=function(imgscope){return $scope.img=imgscope},this.previewFile=function(file){return $scope.img.previewFile(file)}},{restrict:"A",scope:{},controller:controller}}).directive("djangoCradminImagePreviewImg",function(){var controller,link,onFilePreviewLoaded;return onFilePreviewLoaded=function($scope,srcData){return $scope.element.attr("height",""),$scope.element[0].src=srcData,$scope.element.removeClass("ng-hide")},controller=function($scope){$scope.previewFile=function(file){var reader;return reader=new FileReader,reader.onload=function(evt){return onFilePreviewLoaded($scope,evt.target.result)},reader.readAsDataURL(file)}},link=function(scope,element,attrs,previewCtrl){scope.element=element,previewCtrl.setImg(scope),(null==element.attr("src")||""===element.attr("src"))&&element.addClass("ng-hide")},{require:"^djangoCradminImagePreview",restrict:"A",scope:{},controller:controller,link:link}}).directive("djangoCradminImagePreviewFilefield",function(){var link;return link=function(scope,element,attrs,previewCtrl){scope.previewCtrl=previewCtrl,scope.element=element,scope.wrapperelement=element.parent(),element.bind("change",function(evt){var file;return null!=evt.target.files?(file=evt.target.files[0],scope.previewCtrl.previewFile(file)):void 0}),element.bind("mouseover",function(){return scope.wrapperelement.addClass("django_cradmin_filewidget_field_and_overlay_wrapper_hover")}),element.bind("mouseleave",function(){return scope.wrapperelement.removeClass("django_cradmin_filewidget_field_and_overlay_wrapper_hover")})},{require:"^djangoCradminImagePreview",restrict:"A",scope:{},link:link}})}.call(this),function(){angular.module("djangoCradmin",["djangoCradmin.templates","djangoCradmin.directives","djangoCradmin.menu","djangoCradmin.objecttable","djangoCradmin.acemarkdown","djangoCradmin.imagepreview","djangoCradmin.forms.modelchoicefield","djangoCradmin.forms.usethisbutton"])}.call(this),function(){angular.module("djangoCradmin.menu",[]).controller("CradminMenuController",function($scope){return $scope.displayMenu=!1,$scope.toggleNavigation=function(){return $scope.displayMenu=!$scope.displayMenu}})}.call(this),function(){angular.module("djangoCradmin.objecttable",[]).controller("CradminMultiselectObjectTableViewController",["$scope",function($scope){return $scope.selectAllChecked=!1,$scope.numberOfSelected=0,$scope.selectedAction=null,$scope.setCheckboxValue=function(itemkey,value){return $scope.items[itemkey]=value},$scope.getCheckboxValue=function(itemkey){return $scope.items[itemkey]},$scope.toggleAllCheckboxes=function(){return $scope.selectAllChecked=!$scope.selectAllChecked,$scope.numberOfSelected=0,angular.forEach($scope.items,function(checked,itemkey){return $scope.setCheckboxValue(itemkey,$scope.selectAllChecked),$scope.selectAllChecked?$scope.numberOfSelected+=1:void 0})},$scope.toggleCheckbox=function(itemkey){var newvalue;return newvalue=!$scope.getCheckboxValue(itemkey),$scope.setCheckboxValue(itemkey,newvalue),newvalue?$scope.numberOfSelected+=1:($scope.numberOfSelected-=1,$scope.selectAllChecked=!1)}}])}.call(this),angular.module("djangoCradmin.templates",["acemarkdown/acemarkdown.tpl.html"]),angular.module("acemarkdown/acemarkdown.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("acemarkdown/acemarkdown.tpl.html","<div ng-transclude></div>")}]),function(){angular.module("djangoCradmin.wysihtml",[]).directive("djangoCradminWysihtml",function(){return{restrict:"A",transclude:!0,template:"<div><p>Stuff is awesome!</p><div ng-transclude></div></div>"}})}.call(this);
//# sourceMappingURL=cradmin.min.js.map